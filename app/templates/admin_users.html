{% extends "base.html" %}

{% block content %}
<section class="card">
  <h2>用户管理（管理员）</h2>
  {% if message %}
    <p class="message">{{ message }}</p>
  {% endif %}
  {% if users %}
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>用户名</th>
          <th>角色</th>
          <th>创建时间</th>
          <th>重置密码</th>
        </tr>
      </thead>
      <tbody>
      {% for u in users %}
        <tr>
          <td>{{ u.id }}</td>
          <td>{{ u.username }}</td>
          <td>{% if u.is_admin %}admin{% else %}user{% endif %}</td>
          <td>{{ u.created_at }}</td>
          <td>
            <form action="/admin/users/{{ u.id }}/reset-password" method="post" class="inline-form" onsubmit="return confirm('确定重置该用户密码吗？');">
              <input type="password" name="new_password" placeholder="新密码(>=6位)" required minlength="6" />
              <button type="submit" class="danger">重置</button>
            </form>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>暂无用户。</p>
  {% endif %}
</section>
{% endblock %}
